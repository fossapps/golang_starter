sudo: required
services:
  - docker
language: go
go:
  - "1.8"
  - "1.9"
  - "1.10"
  - "tip"
before_install:
  - go get -u github.com/golang/dep/cmd/dep
  - go get -u golang.org/x/lint/golint
  - dep ensure
  - docker-compose up -d
jobs:
  include:
    - stage: code style
    - script: make lint && go vet
    - stage: test
    - script: make migrate && make test && make test-integration && make build
stages:
  - code style
  - test
